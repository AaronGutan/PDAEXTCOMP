# üöÄ PdfImageAddIn - –í–Ω–µ—à–Ω—è—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –¥–ª—è 1–°:–ü—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ 8

![Build Status](https://img.shields.io/badge/build-passing-brightgreen)
![Language](https://img.shields.io/badge/language-C%2B%2B-blue)
![Platform](https://img.shields.io/badge/platform-Windows-lightgrey)
![Version](https://img.shields.io/badge/version-1.0-orange)

–í–Ω–µ—à–Ω—è—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PDF –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –≤ 1–°:–ü—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ 8. –ü–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ PDF —Ñ–∞–π–ª—ã —Å –≤–∏–∑—É–∞–ª—å–Ω—ã–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º drag-and-drop.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∞](#-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞)
- [üöÄ –ë—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞](#-–±—ã—Å—Ç—Ä–∞—è-—Å–±–æ—Ä–∫–∞)
- [üåê –û–Ω–ª–∞–π–Ω –∫–æ–º–ø–∏–ª—è—Ü–∏—è](#-–æ–Ω–ª–∞–π–Ω-–∫–æ–º–ø–∏–ª—è—Ü–∏—è)
- [üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)
- [üõ†Ô∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#Ô∏è-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#-–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

## üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

### **PdfImageAddIn** - –†–∞–±–æ—Ç–∞ —Å PDF —Ñ–∞–π–ª–∞–º–∏ ‚≠ê
> –í–Ω–µ—à–Ω—è—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ PDF –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ PDF —Ñ–∞–π–ª–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —Ç–æ—á–Ω—ã–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏
- ‚úÖ **Drag & Drop —Ä–µ–¥–∞–∫—Ç–æ—Ä** - –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö PDF
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å PDFium

**–§–∞–π–ª—ã:**
- `PdfImageAddIn.dll` - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
- `PdfImageComp.htm` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `example.1c` - –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### **AddIn** - –ë–∞–∑–æ–≤–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
> –û—Å–Ω–æ–≤–∞ –¥–ª—è –≤–Ω–µ—à–Ω–µ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ COM –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- ‚úÖ –§–∞–±—Ä–∏–∫–∞ –∫–ª–∞—Å—Å–æ–≤
- ‚úÖ –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã

## üöÄ –ë—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ (Windows)
```batch
# –°–∫–∞—á–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç
git clone <repository-url>
cd PDAEXTCOMP

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–±–æ—Ä–∫—É
build.bat
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Makefile
```bash
# –ü–æ–ª–Ω–∞—è —Å–±–æ—Ä–∫–∞ —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π PDFium
make full_build

# –¢–æ–ª—å–∫–æ –∫–æ–º–ø–∏–ª—è—Ü–∏—è
make all

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
make test
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–±–æ—Ä–∫–∏
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Å–±–æ—Ä–∫–∏ –≤ –ø–∞–ø–∫–µ `bin/`:
- `PdfImageAddIn.dll` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PDF

## üåê –û–Ω–ª–∞–π–Ω –∫–æ–º–ø–∏–ª—è—Ü–∏—è

### GitHub Actions (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) ‚≠ê
```yaml
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞!
# 1. –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
# 2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Actions ‚Üí Build PdfImageAddIn
# 3. –ù–∞–∂–º–∏—Ç–µ "Run workflow"
# 4. –°–∫–∞—á–∞–π—Ç–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
```

### –î—Ä—É–≥–∏–µ —Å–ø–æ—Å–æ–±—ã
- **GitHub Codespaces** - –ø–æ–ª–Ω–∞—è IDE –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- **Gitpod** - —Å—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤ –æ–±–ª–∞–∫–µ
- **Replit** - –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Ç–µ—Å—Ç–æ–≤
- **Compiler Explorer** - –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞

> üìñ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: [ONLINE_BUILD.md](ONLINE_BUILD.md)

### –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç
```batch
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞
quick_test.bat

# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç
start online_compiler_test.html
```

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –§–∞–π–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- üìã [CompDev.htm](CompDev.htm) - –ü–æ—Ä—è–¥–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ AddIn
- üìã [PdfImageComp.htm](PdfImageComp.htm) - –û–ø–∏—Å–∞–Ω–∏–µ PdfImageAddIn.dll
- üìã [Readme.htm](Readme.htm) - –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ—Å—Ç–∞–≤–∫–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- üîß [PDFIUM_INSTALL.md](Source/PdfImageAddIn/PDFIUM_INSTALL.md) - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PDFium
- üåê [ONLINE_BUILD.md](ONLINE_BUILD.md) - –û–Ω–ª–∞–π–Ω –∫–æ–º–ø–∏–ª—è—Ü–∏—è
- üìö [README.md](Source/PdfImageAddIn/README.md) - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ PdfImageAddIn

## üõ†Ô∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ
- **OS:** Windows 10/11
- **–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä:** Visual Studio 2019+
- **–°—Ä–µ–¥–∞:** PowerShell 5.1+

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ
- **IDE:** Visual Studio 2022 Community
- **SDK:** Windows SDK 10.0.19041.0
- **–°–∏—Å—Ç–µ–º–∞:** Git –¥–ª—è Windows

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **PDFium** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è
- **COM –±–∏–±–ª–∏–æ—Ç–µ–∫–∏** - –≤—Å—Ç—Ä–æ–µ–Ω—ã –≤ Windows
- **C++ Runtime** - –≤–∫–ª—é—á–µ–Ω –≤ Visual Studio

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### PdfImageAddIn –≤ 1–°
```javascript
// –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
–í–Ω–µ—à–Ω—è—è–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ = –ù–æ–≤—ã–π COM–û–±—ä–µ–∫—Ç("Addin.PdfImageAddIn");

// –ó–∞–≥—Ä—É–∑–∫–∞ PDF —Ñ–∞–π–ª–∞
–ï—Å–ª–∏ –í–Ω–µ—à–Ω—è—è–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.–ó–∞–≥—Ä—É–∑–∏—Ç—å–ü–¥—Ñ("C:\Documents\document.pdf") –¢–æ–≥–¥–∞
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–æ—Ç–∏–ø–∞ –Ω–∞ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
    –í–Ω–µ—à–Ω—è—è–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.–î–æ–±–∞–≤–∏—Ç—å–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ(
        "C:\Images\logo.png",  // –ü—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é
        100,                   // X –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞
        700,                   // Y –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞  
        200,                   // –®–∏—Ä–∏–Ω–∞
        100,                   // –í—ã—Å–æ—Ç–∞
        1                      // –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    );
    
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    –í–Ω–µ—à–Ω—è—è–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.–°–æ—Ö—Ä–∞–Ω–∏—Ç—å–ü–¥—Ñ("C:\Documents\result.pdf");
    
–ö–æ–Ω–µ—Ü–ï—Å–ª–∏;
```

### Drag & Drop —Ä–µ–¥–∞–∫—Ç–æ—Ä
```javascript
// –û—Ç–∫—Ä—ã—Ç–∏–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
–ï—Å–ª–∏ –í–Ω–µ—à–Ω—è—è–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.–û—Ç–∫—Ä—ã—Ç—åDragDrop–†–µ–¥–∞–∫—Ç–æ—Ä() –¢–æ–≥–¥–∞
    –°–æ–æ–±—â–∏—Ç—å("Drag & Drop —Ä–µ–¥–∞–∫—Ç–æ—Ä –æ—Ç–∫—Ä—ã—Ç!");
    –°–æ–æ–±—â–∏—Ç—å("–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞");
    
    // –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
    –í–Ω–µ—à–Ω—è—è–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.–ü–æ–∫–∞–∑–∞—Ç—å–°–ø—Ä–∞–≤–∫—ÉDragDrop();
    
    // –û–∫–Ω–æ –æ—Å—Ç–∞–µ—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    
–ö–æ–Ω–µ—Ü–ï—Å–ª–∏;
```



### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
```cmd
:: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
regsvr32 bin\PdfImageAddIn.dll

:: –û—Ç–º–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
regsvr32 /u bin\PdfImageAddIn.dll
```

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º—ã –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
```batch
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞
where cl
where link

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvars32.bat"

# –û—á–∏—Å—Ç–∫–∞ –∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞
make clean
make all
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å PDFium
```batch
# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ PDFium
make install_pdfium

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
dir include\fpdfview.h
dir lib\pdfium.lib
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
```batch
# –ü—Ä–æ–≤–µ—Ä–∫–∞ DLL
dumpbin /imports bin\PdfImageAddIn.dll

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Runtime
# https://aka.ms/vs/17/release/vc_redist.x86.exe
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª—ã | –†–∞–∑–º–µ—Ä | –°—Ç–∞—Ç—É—Å |
|-----------|--------|--------|--------|
| PdfImageAddIn | 12 | ~500KB | ‚úÖ –ì–æ—Ç–æ–≤ |
| AddIn (–±–∞–∑–∞) | 6 | ~200KB | ‚úÖ –ì–æ—Ç–æ–≤ |

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ (`git checkout -b feature/AmazingFeature`)
3. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add some AmazingFeature'`)
4. –ó–∞–ø—É—à—å—Ç–µ –≤ –≤–µ—Ç–∫—É (`git push origin feature/AmazingFeature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è "–∫–∞–∫ –µ—Å—Ç—å" –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å 1–°:–ü—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ 8.

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- üåê [1–°:–ü—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ](https://v8.1c.ru/)
- üîß [PDFium](https://pdfium.googlesource.com/pdfium/)
- üíª [Visual Studio](https://visualstudio.microsoft.com/)
- üöÄ [GitHub Actions](https://github.com/features/actions)

---

**‚≠ê –ü–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥–æ—á–∫—É –ø—Ä–æ–µ–∫—Ç—É, –µ—Å–ª–∏ –æ–Ω –æ–∫–∞–∑–∞–ª—Å—è –ø–æ–ª–µ–∑–Ω—ã–º!**

> üí° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–ª—è –ø–µ—Ä–≤–æ–π —Å–±–æ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ GitHub Actions - –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –±—É–¥—É—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. 