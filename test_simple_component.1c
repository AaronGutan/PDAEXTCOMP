// Тест упрощенной компоненты PdfImageAddIn (без PDFium)
// Сохраните как .1c файл и выполните в 1С

Процедура ТестУпрощеннойКомпоненты()
    
    Попытка
        // Создание COM-объекта
        ВнешняяКомпонента = Новый COMОбъект("Addin.PdfImageAddIn");
        
        Сообщить("✓ COM-объект создан успешно");
        
        // Тест свойства IsEnabled
        ВнешняяКомпонента.IsEnabled = Истина;
        Если ВнешняяКомпонента.IsEnabled Тогда
            Сообщить("✓ Свойство IsEnabled работает");
        КонецЕсли;
        
        // Тест метода TestConnection
        Если ВнешняяКомпонента.TestConnection() Тогда
            Сообщить("✓ Метод TestConnection работает");
        КонецЕсли;
        
        // Тест метода LoadPdf (заглушка)
        Если ВнешняяКомпонента.LoadPdf("C:\test.pdf") Тогда
            Сообщить("✓ Метод LoadPdf работает (заглушка)");
        КонецЕсли;
        
        // Тест метода GetPageCount
        КоличествоСтраниц = ВнешняяКомпонента.GetPageCount();
        Сообщить("✓ Количество страниц: " + КоличествоСтраниц);
        
        // Тест метода GetPageSize
        РазмерСтраницы = ВнешняяКомпонента.GetPageSize(1);
        Сообщить("✓ Размер страницы: " + РазмерСтраницы);
        
        // Тест метода AddImage (заглушка)
        Если ВнешняяКомпонента.AddImage("C:\test.jpg", 100, 100, 200, 150, 1) Тогда
            Сообщить("✓ Метод AddImage работает (заглушка)");
        КонецЕсли;
        
        // Тест метода SavePdf (заглушка)
        Если ВнешняяКомпонента.SavePdf("C:\output.pdf") Тогда
            Сообщить("✓ Метод SavePdf работает (заглушка)");
        КонецЕсли;
        
        // Тест свойства LastError
        Сообщить("✓ Последняя ошибка: " + ВнешняяКомпонента.LastError);
        
        // Тест метода ClearImages
        Если ВнешняяКомпонента.ClearImages() Тогда
            Сообщить("✓ Метод ClearImages работает");
        КонецЕсли;
        
        Сообщить("");
        Сообщить("========================================");
        Сообщить("ВСЕ ТЕСТЫ ПРОЙДЕНЫ УСПЕШНО!");
        Сообщить("Упрощенная компонента работает корректно");
        Сообщить("========================================");
        
    Исключение
        Сообщить("❌ Ошибка: " + ОписаниеОшибки());
        Сообщить("Код ошибки: " + КодОшибки());
        
        // Дополнительная диагностика
        Попытка
            Сообщить("Проверка доступности COM-объекта...");
            ВнешняяКомпонента = Новый COMОбъект("Scripting.FileSystemObject");
            Сообщить("✓ COM работает, проблема в нашей компоненте");
        Исключение
            Сообщить("❌ Проблема с COM в 1С");
        КонецПопытки;
        
    КонецПопытки;
    
КонецПроцедуры

// Запуск теста
ТестУпрощеннойКомпоненты(); 