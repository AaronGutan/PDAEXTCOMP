<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>Описание внешней компоненты PdfImageAddIn.dll</title>
</head>

<body>

<h1 align="center">Описание внешней компоненты PdfImageAddIn.dll</h1>

<h2>Общее описание</h2>

<p>Внешняя компонента <strong>PdfImageAddIn.dll</strong> предназначена для работы с PDF файлами и размещения изображений в 1С:Предприятие 8. Компонента позволяет загружать PDF файлы, добавлять изображения с указанием точных координат и размеров, а также сохранять результат.</p>

<p>Имя для использования в конфигурации: <strong>PdfImageAddIn</strong></p>

<h2>Свойства компоненты</h2>

<h3>Включена (IsEnabled)</h3>
<p>Тип свойства: Булево. Чтение и запись.</p>
<p>0 - выключена, 1 - включена</p>
<p>Определяет состояние того, включена или выключена данная компонента.</p>

<h3>ИмяПдфФайла (PdfFileName)</h3>
<p>Тип свойства: Строка. Чтение и запись.</p>
<p>Содержит имя загруженного PDF файла.</p>

<h3>ИмяФайлаИзображения (ImageFileName)</h3>
<p>Тип свойства: Строка. Чтение и запись.</p>
<p>Содержит имя файла изображения для добавления в PDF.</p>

<h3>КоординатаX (ImageX)</h3>
<p>Тип свойства: Число. Чтение и запись.</p>
<p>X-координата размещения изображения на странице PDF (в точках).</p>

<h3>КоординатаY (ImageY)</h3>
<p>Тип свойства: Число. Чтение и запись.</p>
<p>Y-координата размещения изображения на странице PDF (в точках).</p>

<h3>ШиринаИзображения (ImageWidth)</h3>
<p>Тип свойства: Число. Чтение и запись.</p>
<p>Ширина изображения в точках.</p>

<h3>ВысотаИзображения (ImageHeight)</h3>
<p>Тип свойства: Число. Чтение и запись.</p>
<p>Высота изображения в точках.</p>

<h3>НомерСтраницы (PageNumber)</h3>
<p>Тип свойства: Число. Чтение и запись.</p>
<p>Номер страницы PDF, на которую будет добавлено изображение (начиная с 1).</p>

<h3>ПоследняяОшибка (LastError)</h3>
<p>Тип свойства: Строка. Только чтение.</p>
<p>Содержит описание последней ошибки, возникшей при работе с компонентой.</p>

<h2>Методы компоненты</h2>

<h3>ЗагрузитьПдф (LoadPdf)</h3>
<p>Загружает PDF файл для дальнейшей работы.</p>
<p><strong>Параметры:</strong></p>
<p>ИмяФайла - обязательный параметр. Строка с полным путем к PDF файлу.</p>
<p><strong>Возвращает:</strong> Булево - успешность операции.</p>

<h3>ДобавитьИзображение (AddImage)</h3>
<p>Добавляет изображение в PDF файл с указанными координатами и размерами.</p>
<p><strong>Параметры:</strong></p>
<ul>
<li>ИмяФайлаИзображения - путь к файлу изображения</li>
<li>КоординатаX - X-позиция на странице</li>
<li>КоординатаY - Y-позиция на странице</li>
<li>Ширина - ширина изображения</li>
<li>Высота - высота изображения</li>
<li>НомерСтраницы - номер страницы для размещения</li>
</ul>
<p><strong>Возвращает:</strong> Булево - успешность операции.</p>

<h3>СохранитьПдф (SavePdf)</h3>
<p>Сохраняет PDF файл с внесенными изменениями.</p>
<p><strong>Параметры:</strong></p>
<p>ИмяФайла - путь для сохранения файла.</p>
<p><strong>Возвращает:</strong> Булево - успешность операции.</p>

<h3>РазмерСтраницы (GetPageSize)</h3>
<p>Получает размеры указанной страницы PDF.</p>
<p><strong>Параметры:</strong></p>
<p>НомерСтраницы - номер страницы для получения размеров.</p>
<p><strong>Возвращает:</strong> Строка в формате "ширина,высота" или пустая строка в случае ошибки.</p>

<h3>ОчиститьИзображения (ClearImages)</h3>
<p>Удаляет все добавленные изображения из PDF.</p>
<p><strong>Возвращает:</strong> Булево - успешность операции.</p>

<h3>КоличествоСтраниц (GetPageCount)</h3>
<p>Получает общее количество страниц в загруженном PDF файле.</p>
<p><strong>Возвращает:</strong> Число - количество страниц.</p>

<h2>Пример использования</h2>

<pre>
// Подключение компоненты
ВнешняяКомпонента = Новый COMОбъект("Addin.PdfImageAddIn");

// Загрузка PDF файла
Если ВнешняяКомпонента.ЗагрузитьПдф("C:\Documents\document.pdf") Тогда
    
    // Получение размеров первой страницы
    РазмерСтраницы = ВнешняяКомпонента.РазмерСтраницы(1);
    
    // Добавление изображения на первую страницу
    Если ВнешняяКомпонента.ДобавитьИзображение(
        "C:\Images\logo.png",  // Путь к изображению
        100,                   // X-координата
        700,                   // Y-координата
        200,                   // Ширина
        100,                   // Высота
        1                      // Номер страницы
    ) Тогда
        
        // Сохранение результата
        ВнешняяКомпонента.СохранитьПдф("C:\Documents\result.pdf");
        
    Иначе
        Сообщить("Ошибка добавления изображения: " + ВнешняяКомпонента.ПоследняяОшибка);
    КонецЕсли;
    
Иначе
    Сообщить("Ошибка загрузки PDF: " + ВнешняяКомпонента.ПоследняяОшибка);
КонецЕсли;
</pre>

<h2>Технические особенности</h2>

<ul>
<li>Компонента использует систему координат PDF, где точка (0,0) находится в левом нижнем углу страницы</li>
<li>Координаты и размеры указываются в точках (1 дюйм = 72 точки)</li>
<li>Поддерживаются основные форматы изображений: PNG, JPG, BMP</li>
<li>Для полноценной работы требуется библиотека для работы с PDF (например, PDFium)</li>
</ul>

<h2>Требования к системе</h2>

<ul>
<li>Windows 2000/XP/Vista/7/8/10</li>
<li>1С:Предприятие 8.0 и выше</li>
<li>Библиотека для работы с PDF (PDFium или аналогичная)</li>
</ul>

</body>
</html> 